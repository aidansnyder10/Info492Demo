<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo 2 - Business Admin Portal</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="dashboard-container">
        <header class="dashboard-header">
            <div class="header-left">
                <i class="fas fa-building"></i>
                <h1>Demo 2 - Business Admin Portal</h1>
            </div>
            <div class="header-right">
                <span class="admin-info">
                    <i class="fas fa-user-tie"></i>
                    business@securebank.com
                </span>
                <button class="email-btn" onclick="window.open('demo2-business-email-portal.html', '_blank')">
                    <i class="fas fa-envelope"></i>
                    Email Portal
                </button>
                <button id="logoutBtn" class="logout-btn" onclick="window.location.href='index.html'">
                    <i class="fas fa-sign-out-alt"></i>
                    Back to Main
                </button>
            </div>
        </header>

        <nav class="dashboard-nav">
            <ul>
                <li class="active" data-section="overview">
                    <i class="fas fa-chart-line"></i>
                    Overview
                </li>
                <li data-section="cashflow">
                    <i class="fas fa-money-bill-wave"></i>
                    Cash Flow
                </li>
                <li data-section="invoices">
                    <i class="fas fa-file-invoice-dollar"></i>
                    Invoices
                </li>
                <li data-section="payroll">
                    <i class="fas fa-users"></i>
                    Payroll
                </li>
                <li data-section="approvals">
                    <i class="fas fa-check-double"></i>
                    Approvals
                </li>
                <li data-section="cards">
                    <i class="fas fa-credit-card"></i>
                    Cards & Controls
                </li>
                <li data-section="experiment">
                    <i class="fas fa-flask"></i>
                    AI Experiment
                </li>
            </ul>
        </nav>

        <main class="dashboard-content">
            <!-- Overview -->
            <section id="overview" class="dashboard-section active">
                <h2>Business Overview</h2>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <div class="metric-info">
                            <h3>Total Balance</h3>
                            <span class="metric-value">$1,254,320.45</span>
                            <span class="metric-change positive">+1.2% WoW</span>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-arrow-down-short-wide"></i>
                        </div>
                        <div class="metric-info">
                            <h3>Incoming (30d)</h3>
                            <span class="metric-value">$842,110.00</span>
                            <span class="metric-change positive">+4.5%</span>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-arrow-up-short-wide"></i>
                        </div>
                        <div class="metric-info">
                            <h3>Outgoing (30d)</h3>
                            <span class="metric-value">$693,870.00</span>
                            <span class="metric-change negative">+2.1%</span>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-file-invoice"></i>
                        </div>
                        <div class="metric-info">
                            <h3>Open Invoices</h3>
                            <span class="metric-value">27</span>
                            <span class="metric-change warning">$128,450 due</span>
                        </div>
                    </div>
                </div>

                <div class="charts-grid">
                    <div class="chart-card">
                        <h3>Cash Flow (Last 12 weeks)</h3>
                        <div class="chart-placeholder">
                            <i class="fas fa-chart-area" style="font-size: 2rem; color: #667eea;"></i>
                            <p>Chart will be rendered here</p>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3>Top Vendors by Spend</h3>
                        <div class="chart-placeholder">
                            <i class="fas fa-chart-pie" style="font-size: 2rem; color: #667eea;"></i>
                            <p>Chart will be rendered here</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Cash Flow -->
            <section id="cashflow" class="dashboard-section">
                <div class="section-header">
                    <h2>Cash Flow</h2>
                    <div class="section-actions">
                        <select class="filter-select" id="cf-range">
                            <option>Last 30 days</option>
                            <option>Quarter to date</option>
                            <option>Year to date</option>
                        </select>
                    </div>
                </div>
                <div class="transactions-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Counterparty</th>
                                <th>Type</th>
                                <th>Amount</th>
                                <th>Memo</th>
                            </tr>
                        </thead>
                        <tbody id="cashflow-tbody">
                            <tr>
                                <td>Oct 01, 2025</td>
                                <td>Stripe Payout</td>
                                <td>Incoming</td>
                                <td>+$45,230.00</td>
                                <td>Monthly sales</td>
                            </tr>
                            <tr>
                                <td>Sep 29, 2025</td>
                                <td>Northwest Utilities</td>
                                <td>Outgoing</td>
                                <td>-$3,215.67</td>
                                <td>Utilities</td>
                            </tr>
                            <tr>
                                <td>Sep 28, 2025</td>
                                <td>Payroll</td>
                                <td>Outgoing</td>
                                <td>-$128,900.00</td>
                                <td>Bi-weekly payroll</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Invoices -->
            <section id="invoices" class="dashboard-section">
                <div class="section-header">
                    <h2>Invoices</h2>
                    <div class="section-actions">
                        <input type="text" placeholder="Search invoices..." class="search-input" id="invoice-search">
                        <button class="btn-primary" onclick="createInvoice()">
                            <i class="fas fa-plus"></i>
                            New Invoice
                        </button>
                    </div>
                </div>
                <div class="transactions-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Invoice #</th>
                                <th>Client</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Due Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="invoice-tbody">
                            <tr>
                                <td>INV-2025-1042</td>
                                <td>Acme Corp</td>
                                <td>$12,450.00</td>
                                <td><span class="status pending">Pending</span></td>
                                <td>Oct 15, 2025</td>
                                <td><button class="btn-sm" onclick="markPaid('INV-2025-1042')">Mark Paid</button></td>
                            </tr>
                            <tr>
                                <td>INV-2025-1039</td>
                                <td>Globex</td>
                                <td>$8,900.00</td>
                                <td><span class="status active">Sent</span></td>
                                <td>Oct 10, 2025</td>
                                <td><button class="btn-sm" onclick="sendReminder('INV-2025-1039')">Send Reminder</button></td>
                            </tr>
                            <tr>
                                <td>INV-2025-1031</td>
                                <td>Initech</td>
                                <td>$55,000.00</td>
                                <td><span class="status completed">Paid</span></td>
                                <td>Sep 20, 2025</td>
                                <td><button class="btn-sm" onclick="viewInvoice('INV-2025-1031')">View</button></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Payroll -->
            <section id="payroll" class="dashboard-section">
                <div class="section-header">
                    <h2>Payroll</h2>
                    <div class="section-actions">
                        <button class="btn-secondary" onclick="runPayroll()">
                            <i class="fas fa-play"></i>
                            Run Payroll
                        </button>
                        <button class="btn-secondary" onclick="addEmployee()">
                            <i class="fas fa-user-plus"></i>
                            Add Employee
                        </button>
                    </div>
                </div>
                <div class="transactions-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Employee</th>
                                <th>Role</th>
                                <th>Pay</th>
                                <th>Status</th>
                                <th>Last Paid</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Alex Rivera</td>
                                <td>Engineer</td>
                                <td>$4,500.00</td>
                                <td><span class="status completed">Active</span></td>
                                <td>Sep 28, 2025</td>
                            </tr>
                            <tr>
                                <td>Nina Patel</td>
                                <td>Finance</td>
                                <td>$5,200.00</td>
                                <td><span class="status completed">Active</span></td>
                                <td>Sep 28, 2025</td>
                            </tr>
                            <tr>
                                <td>Chris Lee</td>
                                <td>Ops</td>
                                <td>$4,000.00</td>
                                <td><span class="status completed">Active</span></td>
                                <td>Sep 28, 2025</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Approvals -->
            <section id="approvals" class="dashboard-section">
                <div class="section-header">
                    <h2>Approvals</h2>
                    <div class="section-actions">
                        <button class="btn-primary" onclick="approveAll()">
                            <i class="fas fa-check-circle"></i>
                            Approve All
                        </button>
                    </div>
                </div>
                <div class="recent-activity">
                    <h3>Pending Approvals</h3>
                    <div class="activity-list" id="approval-list">
                        <div class="activity-item">
                            <div class="activity-icon info"><i class="fas fa-file-invoice-dollar"></i></div>
                            <div class="activity-content">
                                <p>Invoice INV-2025-1042 to Acme Corp - $12,450.00</p>
                                <span class="activity-time">Requested by A. Rivera</span>
                            </div>
                            <div class="customer-actions">
                                <button class="btn-sm" onclick="approve('INV-2025-1042')">Approve</button>
                                <button class="btn-sm" onclick="reject('INV-2025-1042')">Reject</button>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon warning"><i class="fas fa-credit-card"></i></div>
                            <div class="activity-content">
                                <p>Card limit increase for Team Card – +$5,000</p>
                                <span class="activity-time">Requested by N. Patel</span>
                            </div>
                            <div class="customer-actions">
                                <button class="btn-sm" onclick="approve('CARD-REQ-17')">Approve</button>
                                <button class="btn-sm" onclick="reject('CARD-REQ-17')">Reject</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Cards & Controls -->
            <section id="cards" class="dashboard-section">
                <div class="section-header">
                    <h2>Cards & Controls</h2>
                    <div class="section-actions">
                        <button class="btn-secondary" onclick="issueCard()">
                            <i class="fas fa-plus"></i>
                            Issue New Card
                        </button>
                    </div>
                </div>
                <div class="customers-grid">
                    <div class="customer-card">
                        <div class="customer-avatar"><i class="fas fa-id-card"></i></div>
                        <div class="customer-info">
                            <h4>Team Card – Ops</h4>
                            <p>Limit: $20,000 • Spend MTD: $8,230</p>
                            <span class="status active">Active</span>
                        </div>
                        <div class="customer-actions">
                            <button class="btn-sm" onclick="setControls('ops')">Controls</button>
                            <button class="btn-sm" onclick="freezeCard('ops')">Freeze</button>
                        </div>
                    </div>
                    <div class="customer-card">
                        <div class="customer-avatar"><i class="fas fa-id-card"></i></div>
                        <div class="customer-info">
                            <h4>Team Card – Engineering</h4>
                            <p>Limit: $30,000 • Spend MTD: $12,540</p>
                            <span class="status active">Active</span>
                        </div>
                        <div class="customer-actions">
                            <button class="btn-sm" onclick="setControls('eng')">Controls</button>
                            <button class="btn-sm" onclick="freezeCard('eng')">Freeze</button>
                        </div>
                    </div>
                    <div class="customer-card">
                        <div class="customer-avatar"><i class="fas fa-id-card"></i></div>
                        <div class="customer-info">
                            <h4>Virtual Card – Marketing</h4>
                            <p>Limit: $10,000 • Spend MTD: $2,145</p>
                            <span class="status active">Active</span>
                        </div>
                        <div class="customer-actions">
                            <button class="btn-sm" onclick="setControls('mktg')">Controls</button>
                            <button class="btn-sm" onclick="freezeCard('mktg')">Freeze</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- AI Experiment Section -->
            <section id="experiment" class="dashboard-section">
                <div class="section-header">
                    <h2>AI Attack Experiment</h2>
                    <div class="section-actions">
                        <button class="btn-primary" onclick="startExperiment()">
                            <i class="fas fa-play"></i>
                            Start Experiment
                        </button>
                        <button class="btn-secondary" onclick="resetExperiment()">
                            <i class="fas fa-refresh"></i>
                            Reset
                        </button>
                    </div>
                </div>
                
                <div class="experiment-controls">
                    <div class="control-group">
                        <label>Attack Scenario:</label>
                        <select id="attack-scenario">
                            <option value="vendor-fraud">Vendor Payment Fraud</option>
                            <option value="payroll-theft">Payroll Manipulation</option>
                            <option value="card-abuse">Corporate Card Abuse</option>
                            <option value="invoice-fraud">Fake Invoice Generation</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label>AI Model:</label>
                        <select id="ai-model">
                            <option value="claude-haiku">Claude Haiku - Real AI Reasoning ($0.25/1M tokens)</option>
                        </select>
                        <small style="color: #666; font-size: 12px; margin-top: 5px; display: block;">
                            Uses Claude API for real AI reasoning. Automatically falls back to enhanced rule-based logic if API fails.
                        </small>
                    </div>
                    
                    <div class="control-group">
                        <label>Attack Intensity:</label>
                        <select id="attack-intensity">
                            <option value="low">Low (Conservative)</option>
                            <option value="medium">Medium (Balanced)</option>
                            <option value="high">High (Aggressive)</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label>Attack Strategy:</label>
                        <select id="attack-strategy">
                            <option value="basic">Basic - Simple rule avoidance</option>
                            <option value="advanced">Advanced - Multi-parameter optimization</option>
                            <option value="expert">Expert - Complex deception strategies</option>
                        </select>
                        <small style="color: #666; font-size: 12px; margin-top: 5px; display: block;">
                            Test how attack sophistication correlates with success rate
                        </small>
                    </div>
                </div>

                <div class="experiment-status">
                    <div class="status-card">
                        <h4>Experiment Status</h4>
                        <div id="experiment-status" class="status-indicator">Ready</div>
                    </div>
                    
                    <div class="status-card">
                        <h4>AI Agent Activity</h4>
                        <div id="ai-activity" class="activity-feed">
                            <p>No activity yet</p>
                        </div>
                    </div>
                    
                    <div class="status-card">
                        <h4>Attack Success Rate</h4>
                        <div id="success-rate" class="metric-value">0%</div>
                    </div>
                </div>

                <!-- Attack Visualization Section -->
                <div class="attack-visualization">
                    <h3>Experiment Execution Flow</h3>
                    <div id="attack-flow" class="attack-flow-container">
                        <div class="attack-step" id="step-1">
                            <div class="step-icon">
                                <i class="fas fa-cog"></i>
                            </div>
                            <div class="step-label">Strategy Selection</div>
                            <div class="step-status" id="strategy-status">Initializing...</div>
                        </div>
                        <div class="flow-arrow">
                            <i class="fas fa-arrow-right"></i>
                        </div>
                        <div class="attack-step" id="step-2">
                            <div class="step-icon">
                                <i class="fas fa-brain"></i>
                            </div>
                            <div class="step-label">AI Attack Generation</div>
                            <div class="step-status" id="attack-status">Processing...</div>
                        </div>
                        <div class="flow-arrow">
                            <i class="fas fa-arrow-right"></i>
                        </div>
                        <div class="attack-step" id="step-3">
                            <div class="step-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="step-label">Defense Evaluation</div>
                            <div class="step-status" id="defense-status">Analyzing...</div>
                        </div>
                        <div class="flow-arrow">
                            <i class="fas fa-arrow-right"></i>
                        </div>
                        <div class="attack-step" id="step-4">
                            <div class="step-icon">
                                <i class="fas fa-balance-scale"></i>
                            </div>
                            <div class="step-label">Decision</div>
                            <div class="step-status" id="decision-status">Evaluating...</div>
                        </div>
                    </div>
                    
                    <!-- Attack Details Panel -->
                    <div id="attack-details" class="attack-details-panel" style="display: none;">
                        <h4>Attack Parameters</h4>
                        <div id="attack-parameters" class="parameters-grid"></div>
                        
                        <h4>Defense Rule Analysis</h4>
                        <div id="rule-analysis" class="rule-analysis"></div>
                    </div>
                </div>

                <div class="experiment-results">
                    <h3>Strategy Comparison Results</h3>
                    <div id="strategy-results" class="strategy-comparison">
                        <div class="strategy-card">
                            <h4>Basic Strategy</h4>
                            <div class="strategy-stats">
                                <div class="stat">
                                    <span class="stat-label">Success Rate:</span>
                                    <span id="basic-success-rate" class="stat-value">0%</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">Attacks:</span>
                                    <span id="basic-attack-count" class="stat-value">0</span>
                                </div>
                            </div>
                        </div>
                        <div class="strategy-card">
                            <h4>Advanced Strategy</h4>
                            <div class="strategy-stats">
                                <div class="stat">
                                    <span class="stat-label">Success Rate:</span>
                                    <span id="advanced-success-rate" class="stat-value">0%</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">Attacks:</span>
                                    <span id="advanced-attack-count" class="stat-value">0</span>
                                </div>
                            </div>
                        </div>
                        <div class="strategy-card">
                            <h4>Expert Strategy</h4>
                            <div class="strategy-stats">
                                <div class="stat">
                                    <span class="stat-label">Success Rate:</span>
                                    <span id="expert-success-rate" class="stat-value">0%</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">Attacks:</span>
                                    <span id="expert-attack-count" class="stat-value">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <h3>Attack Results</h3>
                    <div id="attack-results" class="results-list">
                        <p>No attacks executed yet</p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Supabase CDN -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <!-- Configuration -->
    <script src="config.js"></script>
    
    <!-- AI Agent Scripts -->
    <script src="ai-agent.js"></script>
    <script src="ai-vs-ai-agents.js"></script>
    <script src="demo2-business-dashboard.js"></script>
</body>
</html>
